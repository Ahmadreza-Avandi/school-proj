(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4765],{17289:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/camera/camera",function(){return r(26626)}])},71919:function(e,t,r){"use strict";r.d(t,{Z:function(){return g}});var n=r(87462),i=r(63366),o=r(67294),a=r(90512),s=r(94780),c=r(77527),d=r(44001),u=r(1588),l=r(34867);function h(e){return(0,l.ZP)("MuiCardContent",e)}(0,u.Z)("MuiCardContent",["root"]);var f=r(85893);let v=["className","component"],p=e=>{let{classes:t}=e;return(0,s.Z)({root:["root"]},h,t)},m=(0,c.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}}));var g=o.forwardRef(function(e,t){let r=(0,d.i)({props:e,name:"MuiCardContent"}),{className:o,component:s="div"}=r,c=(0,i.Z)(r,v),u=(0,n.Z)({},r,{component:s}),l=p(u);return(0,f.jsx)(m,(0,n.Z)({as:s,className:(0,a.Z)(l.root,o),ownerState:u,ref:t},c))})},60762:function(e,t,r){"use strict";r.d(t,{Z:function(){return y}});var n=r(87462),i=r(63366),o=r(67294),a=r(90512),s=r(94780),c=r(77527),d=r(44001),u=r(93454),l=r(1588),h=r(34867);function f(e){return(0,h.ZP)("MuiCard",e)}(0,l.Z)("MuiCard",["root"]);var v=r(85893);let p=["className","raised"],m=e=>{let{classes:t}=e;return(0,s.Z)({root:["root"]},f,t)},g=(0,c.ZP)(u.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({overflow:"hidden"}));var y=o.forwardRef(function(e,t){let r=(0,d.i)({props:e,name:"MuiCard"}),{className:o,raised:s=!1}=r,c=(0,i.Z)(r,p),u=(0,n.Z)({},r,{raised:s}),l=m(u);return(0,v.jsx)(g,(0,n.Z)({className:(0,a.Z)(l.root,o),elevation:s?8:void 0,ref:t,ownerState:u},c))})},26626:function(e,t,r){"use strict";r.r(t);var n=r(85893),i=r(67294),o=r(17859),a=r.n(o),s=r(60762),c=r(71919),d=r(96788),u=r(68573),l=r(26541),h=r(84677),f=r(97182),v=r(11163);t.default=()=>{let e=(0,i.useRef)(null),[t,r]=(0,i.useState)(!1),[o,p]=(0,i.useState)("لطفاً به دوربین نگاه کنید"),[m,g]=(0,i.useState)(""),[y,S]=(0,i.useState)(""),[M,b]=(0,i.useState)(""),U=(0,v.useRouter)(),w=async()=>{if(e.current&&!t){r(!0);let t=e.current.getScreenshot();if(!t){p("خطا در گرفتن تصویر. لطفاً دوباره تلاش کنید."),r(!1);return}try{let e=await fetch("http://127.0.0.1:5000/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:t,nationalCode:m,firstName:y,lastName:M})}),r=await e.json();e.ok?(p(r.message||"چهره شناسایی شد!"),U.push("/success")):p(r.message||"خطا در شناسایی چهره.")}catch(e){console.error("Error sending image:",e),p("خطا در ارتباط با سرور.")}r(!1)}};return(0,n.jsx)(s.Z,{style:{maxWidth:600,margin:"auto",padding:16,backgroundColor:"#fff"},children:(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(d.Z,{variant:"h5",color:"primary",style:{textAlign:"center",marginBottom:16},children:"لطفاً به دوربین نگاه کنید"}),(0,n.jsxs)(u.ZP,{container:!0,spacing:2,style:{marginBottom:16},children:[(0,n.jsx)(u.ZP,{item:!0,xs:12,children:(0,n.jsx)(l.Z,{label:"کد ملی",variant:"outlined",fullWidth:!0,value:m,onChange:e=>g(e.target.value)})}),(0,n.jsx)(u.ZP,{item:!0,xs:12,children:(0,n.jsx)(l.Z,{label:"نام",variant:"outlined",fullWidth:!0,value:y,onChange:e=>S(e.target.value)})}),(0,n.jsx)(u.ZP,{item:!0,xs:12,children:(0,n.jsx)(l.Z,{label:"نام خانوادگی",variant:"outlined",fullWidth:!0,value:M,onChange:e=>b(e.target.value)})})]}),(0,n.jsx)(a(),{audio:!1,ref:e,screenshotFormat:"image/jpeg",style:{width:"100%",borderRadius:8},videoConstraints:{facingMode:"user"}}),(0,n.jsx)(h.Z,{variant:"contained",color:"primary",onClick:w,style:{width:"100%",marginTop:16},disabled:t,children:t?(0,n.jsx)(f.Z,{size:24,color:"secondary"}):"ارسال تصویر"}),(0,n.jsx)(d.Z,{variant:"h6",color:"textSecondary",style:{textAlign:"center",marginTop:16},children:o})]})})}},17859:function(e,t,r){var n;n=function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,(function(t){return e[t]}).bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(e,t,r){"use strict";r.r(t);var n,i=r("react"),o=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};function c(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}"undefined"!=typeof window&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t?new Promise(function(r,n){t.call(navigator,e,r,n)}):Promise.reject(Error("getUserMedia is not implemented in this browser"))}));var d=function(e){function t(t){var r=e.call(this,t)||this;return r.canvas=null,r.ctx=null,r.requestUserMediaId=0,r.unmounted=!1,r.state={hasUserMedia:!1},r}return o(t,e),t.prototype.componentDidMount=function(){var e=this.state,t=this.props;if(this.unmounted=!1,!c()){t.onUserMediaError("getUserMedia not supported");return}e.hasUserMedia||this.requestUserMedia(),t.children&&"function"!=typeof t.children&&console.warn("children must be a function")},t.prototype.componentDidUpdate=function(e){var t=this.props;if(!c()){t.onUserMediaError("getUserMedia not supported");return}var r=JSON.stringify(e.audioConstraints)!==JSON.stringify(t.audioConstraints),n=JSON.stringify(e.videoConstraints)!==JSON.stringify(t.videoConstraints),i=e.minScreenshotWidth!==t.minScreenshotWidth,o=e.minScreenshotHeight!==t.minScreenshotHeight;(n||i||o)&&(this.canvas=null,this.ctx=null),(r||n)&&(this.stopAndCleanup(),this.requestUserMedia())},t.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},t.stopMediaStream=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().map(function(t){e.removeTrack(t),t.stop()}),e.getAudioTracks().map(function(t){e.removeTrack(t),t.stop()})):e.stop())},t.prototype.stopAndCleanup=function(){var e=this.state;e.hasUserMedia&&(t.stopMediaStream(this.stream),e.src&&window.URL.revokeObjectURL(e.src))},t.prototype.getScreenshot=function(e){var t=this.state,r=this.props;if(!t.hasUserMedia)return null;var n=this.getCanvas(e);return n&&n.toDataURL(r.screenshotFormat,r.screenshotQuality)},t.prototype.getCanvas=function(e){var t=this.state,r=this.props;if(!this.video||!t.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var n=this.video.videoWidth,i=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var o=n/i;i=(n=r.minScreenshotWidth||this.video.clientWidth)/o,r.minScreenshotHeight&&i<r.minScreenshotHeight&&(n=(i=r.minScreenshotHeight)*o)}this.canvas=document.createElement("canvas"),this.canvas.width=(null==e?void 0:e.width)||n,this.canvas.height=(null==e?void 0:e.height)||i,this.ctx=this.canvas.getContext("2d")}var a=this.ctx,s=this.canvas;return a&&s&&(s.width=(null==e?void 0:e.width)||s.width,s.height=(null==e?void 0:e.height)||s.height,r.mirrored&&(a.translate(s.width,0),a.scale(-1,1)),a.imageSmoothingEnabled=r.imageSmoothing,a.drawImage(this.video,0,0,(null==e?void 0:e.width)||s.width,(null==e?void 0:e.height)||s.height),r.mirrored&&(a.scale(-1,1),a.translate(-s.width,0))),s},t.prototype.requestUserMedia=function(){var e=this,r=this.props,n=function(n,i){var o={video:void 0===i||i};r.audio&&(o.audio=void 0===n||n),e.requestUserMediaId++;var a=e.requestUserMediaId;navigator.mediaDevices.getUserMedia(o).then(function(r){e.unmounted||a!==e.requestUserMediaId?t.stopMediaStream(r):e.handleUserMedia(null,r)}).catch(function(t){e.handleUserMedia(t)})};if("mediaDevices"in navigator)n(r.audioConstraints,r.videoConstraints);else{var i=function(e){return{optional:[{sourceId:e}]}},o=function(e){var t=e.deviceId;return"string"==typeof t?t:Array.isArray(t)&&t.length>0?t[0]:"object"==typeof t&&t.ideal?t.ideal:null};MediaStreamTrack.getSources(function(e){var t=null,a=null;e.forEach(function(e){"audio"===e.kind?t=e.id:"video"===e.kind&&(a=e.id)});var s=o(r.audioConstraints);s&&(t=s);var c=o(r.videoConstraints);c&&(a=c),n(i(t),i(a))})}},t.prototype.handleUserMedia=function(e,t){var r=this.props;if(e||!t){this.setState({hasUserMedia:!1}),r.onUserMediaError(e);return}this.stream=t;try{this.video&&(this.video.srcObject=t),this.setState({hasUserMedia:!0})}catch(e){this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}r.onUserMedia(t)},t.prototype.render=function(){var e=this,t=this.state,r=this.props,n=r.audio,o=(r.forceScreenshotSourceSize,r.disablePictureInPicture),c=(r.onUserMedia,r.onUserMediaError,r.screenshotFormat,r.screenshotQuality,r.minScreenshotWidth,r.minScreenshotHeight,r.audioConstraints,r.videoConstraints,r.imageSmoothing,r.mirrored),d=r.style,u=void 0===d?{}:d,l=r.children,h=s(r,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),f=c?a(a({},u),{transform:(u.transform||"")+" scaleX(-1)"}):u,v={getScreenshot:this.getScreenshot.bind(this)};return i.createElement(i.Fragment,null,i.createElement("video",a({autoPlay:!0,disablePictureInPicture:o,src:t.src,muted:!n,playsInline:!0,ref:function(t){e.video=t},style:f},h)),l&&l(v))},t.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},t}(i.Component);t.default=d},react:function(t,r){t.exports=e}}).default},e.exports=n(r(67294))}},function(e){e.O(0,[6838,9311,8573,2888,9774,179],function(){return e(e.s=17289)}),_N_E=e.O()}]);